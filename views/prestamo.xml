<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>



        <!-- Tree View prestamo Empleado  -->
        <record id="prestamo_tree_view_empleado" model="ir.ui.view">
            <field name="name">prestamo_empleado.libro.tree.view</field>
            <field name="view_type">tree</field>
            <field name="model">prestamo</field>
            <field name="view_mode">tree</field>
            <field name="arch" type="xml">
                <tree default_order="fecha desc">
                    <field name="empleado_id"/>
                    <field name="detalle"/>
                    <field name="saldo" sum="True"/>
                    <field name="monto" string="Total Prestamos" sum="True" widget="monetary"/>
                    <field name="fecha"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <!-- Tree View prestamo Cliente  -->
        <record id="prestamo_tree_view_cliente" model="ir.ui.view">
            <field name="name">prestamo_empleado.libro.tree.view1</field>
            <field name="view_type">tree</field>
            <field name="model">prestamo</field>
            <field name="view_mode">tree</field>
            <field name="arch" type="xml">
                <tree default_order="fecha desc">
                    <field name="cliente_id"/>
                    <field name="detalle"/>
                    <field name="saldo" sum="True"/>
                    <field name="monto" string="Total Prestamos" sum="True" widget="monetary"/>
                    <field name="fecha"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>



        <!-- Abono  -->
        <record id="abono_tree_view" model="ir.ui.view">
            <field name="name">abono_tree</field>
            <field name="view_type">tree</field>
            <field name="model">abono</field>
            <field name="view_mode">tree</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="fecha"/>
                </tree>
            </field>
        </record>






        <!-- Action para prestamos empleados -->
        <record id="prestamo_empleado_action" model="ir.actions.act_window">
            <field name="name">Lista de Prestamos Empleados</field>
            <field name="res_model">prestamo</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="prestamo_tree_view_empleado"/>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('tipo','=', 'empleado')]</field>
            <field name="context">{'default_tipo':'empleado'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Presione aquí para crear un nuevo prestamo.</p>
            </field>
        </record>

        <!-- Action para prestamos clientes -->
        <record id="prestamo_cliente_action" model="ir.actions.act_window">
            <field name="name">Lista de Prestamos Clientes</field>
            <field name="res_model">prestamo</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="prestamo_tree_view_cliente"/>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('tipo','=', 'cliente')]</field>
            <field name="context">{'default_tipo':'cliente'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Presione aquí para crear un nuevo libro de prestamos para empleados.</p>
            </field>
        </record>
        <!-- Action para prestamos por pagar -->
        <record id="prestamo_por_pagar_action" model="ir.actions.act_window">
            <field name="name">Lista de Prestamos por pagar</field>
            <field name="res_model">prestamo</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="prestamo_tree_view_cliente"/>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('tipo','=', 'por_pagar')]</field>
            <field name="context">{'default_tipo':'por_pagar'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Presione aquí para crear un nuevo prestamo.</p>
            </field>
        </record>


        <!-- Action Abono -->
        <record id="abono_action" model="ir.actions.act_window">
            <field name="name">Abono</field>
            <field name="res_model">abono</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="abono_tree_view"/>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Abono</p>
            </field>
        </record>



      



        <!-- Form View Prestamo-->
        <record id="prestamo_amortizable_empleado_form_view" model="ir.ui.view">
            <field name="name">Form View: Prestamo</field>
            <field name="view_type">form</field>
            <field name="model">prestamo</field>
            <field name="arch" type="xml">
                <form string="Prestamo" version="7.0">
                    <header>
                        <button  class="oe_highlight" name="action_cerrado" string="Incobrable" type="object"  groups="base.group_system"/>
                        <button  class="oe_highlight" name="action_incobrable" string="Cerrado" type="object" groups="base.group_system"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet string="Prestamo">
                        <h1 class="mt0">
                            <div>
                            
                            </div>
                        </h1>
                        <group>
                            <group>
                                <field invisible="1" name="tipo"/>
                                <field attrs="{'invisible':[('tipo','!=', 'empleado')], 'readonly':[('state','not in',['borrador'])] }" name="empleado_id"/>
                                <field attrs="{'invisible':[('tipo','==', 'empleado')], 'readonly':[('state','not in',['borrador'])] }" name="cliente_id"/>
                                <field name="detalle"/>
                                <field attrs="{'readonly':[('state','not in',['borrador'])]}" name="monto"/>
                                <field name="total_abonos"/>
                            </group>
                            <group string="Saldo">
                                <h3>
                                    <field  name="saldo" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </h3>
                            </group>
                            <group string=""/>
                            <group string=""/>
                        </group>
                        <notebook>
                            <page string="Abonos">
                                <field attrs="{'readonly':[('state','not in',['abierto'])]}" colspan="4" name="abono_ids" nolabel="1" widget="one2many_list">
                                    <tree editable="bottom">
                                        <field name="responsable"/>
                                        <field name="fecha"/>
                                        <field name="monto" attrs="{'readonly':[('state','not in',['borrador'])]}" sum="True" />
                                        <field name="detalle"  attrs="{'readonly':[('state','not in',['borrador'])]}" />
                                        <button icon="fa-print" name="action_imprimir" type="object"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field groups="base.group_user" name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>




        <!-- Form View Abono-->
        <record id="prestamo_abono_form_view" model="ir.ui.view">
            <field name="name">Form View: Abono</field>
            <field name="view_type">form</field>
            <field name="model">abono</field>
            <field name="arch" type="xml">
                <form string="abono" version="7.0">
                    <header>

                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet string="Abono">
                        <h1 class="mt0">
                            <div>
                            
                            </div>
                        </h1>
                        <group>
                            
                            <group>
                                
                                    <field name="prestamo_id"/>
                                    <field name="responsable"/>
                                    <field name="monto"/>
                                    <field name="fecha"/>
                                
                            </group>
                            <group string=""/>
                            <group string=""/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>







        <!-- Search View prestamo Clientes 
    <record id="prestamo_libro_search_view" model="ir.ui.view"><field name="name">prestamo.search</field><field name="model">cliente.allowance</field><field name="arch" type="xml"><search string="Libro"><field  name="res_partner_id"/><group string="Agrupar Por"><filter string="Cliente" name="res_partner_id" domain="[]" context="{'group_by':'res_partner_id'}"/><filter string="state" name="estado" domain="[]" context="{'group_by':'estado'}"/></group></search></field></record>-->
        <!-- Menu Principal -->
        <menuitem id="libroprestamo" name="Prestamos" sequence="30" web_icon="prestamos,static/icon.png"/>
        <menuitem action="prestamo_empleado_action" id="menu_prestamo_empleado" name="Empleados" parent="libroprestamo"/>
        <menuitem action="prestamo_cliente_action" id="menu_prestamo_cliente" name="Clientes" parent="libroprestamo"/>
        <menuitem action="prestamo_por_pagar_action" id="menu_prestamo_por_pagar" name="Por Pagar" parent="libroprestamo"/>

        <menuitem action="abono_action" id="menu_abono" name="Abonos" parent="libroprestamo"/>




    </data>
</openerp>